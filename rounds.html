<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Rounds | CAPITAL Paradox</title>

<script src="https://cdn.tailwindcss.com"></script>
<script src="https://unpkg.com/lucide@latest"></script>

<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Inter:wght@300;400;600&family=Dancing+Script:wght@700&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">

<script>
tailwind.config = {
    theme: {
        extend: {
            colors: {
                'capital-red': '#DC2626',
                'void-black': '#050505',
            },
            fontFamily: {
                'display': ['Bebas Neue', 'sans-serif'],
                'script': ['Dancing Script', 'cursive'],
                'mono': ['JetBrains Mono', 'monospace'],
                'body': ['Inter', 'sans-serif']
            }
        }
    }
}
</script>

<style>
body { background-color: #050505; color: #FAFAFA; }
.grid-bg {
    background-image: linear-gradient(rgba(220, 38, 38, 0.03) 1px, transparent 1px),
                      linear-gradient(90deg, rgba(220, 38, 38, 0.03) 1px, transparent 1px);
    background-size: 50px 50px;
}
.nav-link::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 1px;
    background: #DC2626;
    transform: translateX(-100%);
    transition: transform 0.3s;
}
.nav-link:hover::after {
    transform: translateX(0);
}
.locked-overlay {
    background: rgba(5, 5, 5, 0.95);
    backdrop-filter: blur(4px);
}
.classified-stamp {
    transform: rotate(-5deg);
    border: 3px solid #DC2626;
    color: #DC2626;
    font-family: 'Bebas Neue', sans-serif;
    letter-spacing: 0.3em;
    opacity: 0.8;
}
.code-input {
    background: rgba(220, 38, 38, 0.1);
    border: 2px solid #DC2626;
    color: white;
    text-align: center;
    letter-spacing: 0.2em;
}
.code-input:focus {
    background: rgba(220, 38, 38, 0.2);
    outline: none;
    box-shadow: 0 0 20px rgba(220, 38, 38, 0.3);
}
.unlock-btn {
    background: #DC2626;
    color: white;
    border: none;
    cursor: pointer;
    transition: all 0.3s;
}
.unlock-btn:hover {
    background: white;
    color: #DC2626;
}
.shake {
    animation: shake 0.5s;
}
@keyframes shake {
    0%, 100% { transform: translateX(0); }
    25% { transform: translateX(-10px); }
    75% { transform: translateX(10px); }
}
.blur-content {
    filter: blur(8px);
    user-select: none;
    pointer-events: none;
}
@keyframes glitch {
    0% { transform: translate(0) }
    20% { transform: translate(-2px, 2px) }
    40% { transform: translate(-2px, -2px) }
    60% { transform: translate(2px, 2px) }
    80% { transform: translate(2px, -2px) }
    100% { transform: translate(0) }
}
.glitch-text {
    animation: glitch 2s infinite;
}
@media (max-width: 768px) {
    .mobile-nav {
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        background: rgba(5, 5, 5, 0.95);
        backdrop-filter: blur(10px);
        border-top: 1px solid rgba(220, 38, 38, 0.3);
        z-index: 50;
        padding: 12px 20px;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }
    .content-padding { padding-bottom: 80px; }
}
@media (min-width: 769px) { .mobile-nav { display: none; } }
</style>
</head>
<body class="font-body bg-void-black content-padding">

    <!-- Desktop Navigation -->
    <nav class="fixed top-0 w-full z-50 bg-void-black/95 backdrop-blur-md border-b border-capital-red/20">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-20">
                <a href="index.html" class="flex items-center space-x-2">
                    <span class="font-display text-3xl tracking-wider text-white">CAPITAL</span>
                    <span class="font-script text-2xl text-capital-red -rotate-6">Paradox</span>
                </a>
                <div class="hidden md:flex space-x-8 font-mono text-sm tracking-widest">
                    <a href="index.html" class="nav-link relative text-gray-400 hover:text-white py-2 transition-colors">HOME</a>
                    <a href="rounds.html" class="nav-link relative text-white py-2">ROUNDS</a>
                    <a href="rules.html" class="nav-link relative text-gray-400 hover:text-white py-2 transition-colors">RULES</a>
                    <a href="contact.html" class="text-capital-red hover:text-white transition-colors border border-capital-red px-6 py-2 hover:bg-capital-red">REGISTER</a>
                </div>
                <button class="md:hidden text-white" onclick="document.getElementById('mobile-menu').classList.toggle('hidden')">
                    <i data-lucide="menu" class="w-6 h-6"></i>
                </button>
            </div>
        </div>
        <div id="mobile-menu" class="hidden md:hidden bg-void-black border-b border-capital-red/20">
            <div class="px-4 pt-2 pb-6 space-y-2 font-mono">
                <a href="index.html" class="block py-2 text-gray-400">HOME</a>
                <a href="rounds.html" class="block py-2 text-white">ROUNDS</a>
                <a href="rules.html" class="block py-2 text-gray-400">RULES</a>
                <a href="contact.html" class="block py-2 text-capital-red">REGISTER</a>
            </div>
        </div>
    </nav>

    <!-- Header -->
    <section class="pt-32 pb-12 grid-bg" id="main-content" style="display: none;">
        <div class="max-w-7xl mx-auto px-4">
            <span class="font-mono text-capital-red text-sm tracking-widest">SEQUENTIAL EXECUTION PROTOCOL</span>
            <h1 class="font-display text-5xl md:text-8xl text-white mt-2">THE ROUNDS</h1>
            <p id="welcome" class="text-capital-red mt-4 font-mono text-lg"></p>
        </div>
    </section>

    <!-- Rounds Container -->
    <section class="py-12 bg-void-black" id="rounds-section" style="display: none;">
        <div id="rounds-container" class="max-w-6xl mx-auto px-4 space-y-12"></div>
    </section>

    <!-- Mobile Bottom Navigation -->
    <div class="mobile-nav md:hidden">
        <a href="index.html" class="flex flex-col items-center text-gray-400">
            <i data-lucide="arrow-left" class="w-5 h-5"></i>
            <span class="text-[10px] mt-1 font-mono">BACK</span>
        </a>
        <a href="index.html" class="flex flex-col items-center text-gray-500">
            <i data-lucide="home" class="w-5 h-5"></i>
            <span class="text-[10px] mt-1 font-mono">HOME</span>
        </a>
        <a href="rules.html" class="flex flex-col items-center text-gray-400 hover:text-white">
            <i data-lucide="arrow-right" class="w-5 h-5"></i>
            <span class="text-[10px] mt-1 font-mono">NEXT</span>
        </a>
    </div>

    <!-- Team Login Screen -->
    <div id="team-login-screen" class="fixed inset-0 bg-[#050505] flex items-center justify-center z-[999]" style="display: none;">
        <div class="border border-red-700 p-10 rounded-lg text-center max-w-md w-full mx-4">
            <h2 class="text-2xl mb-4">TEAM ACCESS PORTAL</h2>
            <input id="team-login-input" class="code-input w-full p-4 rounded mb-4" placeholder="ENTER TEAM CODE">
            <button onclick="login()" class="unlock-btn w-full py-3 mb-6">ACCESS</button>
            <div class="flex flex-wrap justify-center gap-6 text-sm font-mono">
                <a href="index.html" class="text-gray-400 hover:text-white transition-colors">HOME</a>
                <a href="rounds.html" class="text-capital-red">ROUNDS</a>
                <a href="rules.html" class="text-gray-400 hover:text-white transition-colors">RULES</a>
                <a href="contact.html" class="text-gray-400 hover:text-white transition-colors">REGISTER</a>
            </div>
        </div>
    </div>

    <!-- Elimination Screen -->
    <div id="elimination-screen" class="fixed inset-0 bg-[#050505] flex items-center justify-center z-[998]" style="display: none;">
        <div class="text-center max-w-2xl mx-4">
            <!-- Elimination Icon -->
            <div class="mb-8 flex justify-center">
                <div class="relative">
                    <div class="w-32 h-32 border-4 border-capital-red rounded-full flex items-center justify-center animate-pulse">
                        <i data-lucide="x" class="w-20 h-20 text-capital-red"></i>
                    </div>
                </div>
            </div>

            <!-- Eliminated Text with strikethrough effect -->
            <h1 class="font-display text-5xl md:text-7xl text-capital-red mb-6 relative inline-block">
                <span class="relative">
                    ELIMINATED
                    <span class="absolute inset-0 flex items-center">
                        <span class="w-full border-t-4 border-capital-red"></span>
                    </span>
                </span>
            </h1>

            <!-- Message -->
            <div class="space-y-4 mb-8">
                <p class="text-white text-2xl md:text-3xl font-display">YOUR TEAM HAS BEEN ELIMINATED</p>
                <p class="text-gray-400 font-mono text-sm">Thank you for participating in CAPITAL Paradox.</p>
                <p id="elim-round-name" class="text-capital-red font-mono text-lg"></p>
            </div>

            <!-- Return Button -->
            <button onclick="closeEliminationScreen()" class="bg-capital-red text-white font-mono px-8 py-3 hover:bg-white hover:text-capital-red transition-all border border-capital-red">
                RETURN TO ROUNDS
            </button>
        </div>
    </div>

    <script>
        // ==========================================
        // OBFUSCATION: Simpler, more reliable approach
        // ==========================================
        
        // Simple ROT-based encoding (easier to debug, still obscures code)
        const _rot = (str, shift) => {
            return str.split('').map(char => {
                const code = char.charCodeAt(0);
                return String.fromCharCode(code + shift);
            }).join('');
        };
        
        const _encode = (str) => btoa(_rot(str, 7));
        const _decode = (str) => _rot(atob(str), -7);
        
        // ==========================================
        // ENCODED ADMIN CODE
        // ==========================================
        
        // Admin code: FAZILBHAITHEBEST
        // Encoded with ROT7 + Base64
        const _ADMIN = "TUhhUFNJT0hQW09MSUxaWw==";
        
        // Storage keys (encoded)
        const _K1 = "amh3cHtoc2Z3aHloa3Z/ZntsaHQ=";  // capital_paradox_team
        const _K2 = "W0xIVGZaW0hbTA==";              // TEAM_STATE
        const _K3 = "SkhXUFtIU2ZLTEpZYFdbTEs=";      // CAPITAL_DECRYPTED
        const _K4 = "SEtUUFVmVFZLTA==";              // ADMIN_MODE
        const _K5 = "W0xIVGZTUFpb";                  // TEAM_LIST
        
        // ==========================================
        // DATA INTEGRITY CHECK
        // ==========================================
        
        const _hash = (obj) => {
            const str = JSON.stringify(obj);
            let h = 0;
            for(let i = 0; i < str.length; i++) {
                h = ((h << 5) - h) + str.charCodeAt(i);
                h = h & h;
            }
            return h.toString(36);
        };
        
        // Protected localStorage functions
        const _get = (key) => {
            try {
                const raw = localStorage.getItem(key);
                if(!raw) return null;
                const parsed = JSON.parse(raw);
                if(parsed._h !== _hash(parsed.d)) {
                    console.warn('Integrity check failed');
                    return null;
                }
                return parsed.d;
            } catch(e) {
                return null;
            }
        };
        
        const _set = (key, value) => {
            localStorage.setItem(key, JSON.stringify({
                d: value,
                _h: _hash(value),
                _t: Date.now()
            }));
        };
        
        // ==========================================
        // INITIALIZE
        // ==========================================
        
        // Initialize default teams if none exist
        if(!_get(_K5)){
            _set(_K5, ["ALPHA", "BETA", "GAMMA"]);
        }
        
        if(!_get(_K2)){
            _set(_K2, {
                1:{ALPHA:"revoked",BETA:"revoked",GAMMA:"revoked"},
                2:{ALPHA:"revoked",BETA:"revoked",GAMMA:"revoked"},
                3:{ALPHA:"revoked",BETA:"revoked",GAMMA:"revoked"},
                4:{ALPHA:"revoked",BETA:"revoked",GAMMA:"revoked"}
            });
        }

        if(!_get(_K3)){
            _set(_K3, {});
        }

        function getState(){
            return _get(_K2) || {};
        }

        function getDecrypted(){
            return _get(_K3) || {};
        }

        function login(){
            const v = document.getElementById("team-login-input").value.trim().toUpperCase();

            // Decode admin code
            const adminCode = _decode(_ADMIN);
            
            // Check if this is admin login
            if(v === adminCode){
                // Clear any team data
                localStorage.removeItem(_K1);
                // Set admin mode
                _set(_K4, "true");
                // Redirect to admin panel immediately
                window.location.replace("admin.html");
                return; // Stop all further execution
            }

            // This is a team login
            _set(_K4, "false");
            _set(_K1, v);
            render();
        }

        const roundsData = [
            {
                id: 1,
                title: "THE AUCTION OF CONSEQUENCES",
                subtitle: "Survival of the fastest. Greed is good. Until it isn't.",
                concept: "HIGH-FREQUENCY MARKET CHAOS",
                icon: "trending-up",
                description: "Teams enter a high-pressure trading floor simulation where market volatility is extreme and windows of opportunity last seconds. Assets fluctuate in real-time based on randomized market shocks.",
                mechanism: [
                    "Rapid-fire trading intervals (30-second decision windows)",
                    "Leveraged positions allowed (and encouraged)",
                    "Market crashes triggered without warning"
                ],
                elimination: [
                    "Portfolio liquidation (bankruptcy)",
                    "Failure to meet minimum trade thresholds",
                    "Margin call defaults"
                ],
                skills: "Risk tolerance • Quick calculation • Market timing • Psychological resilience"
            },
            {
                id: 2,
                title: "DIVIDED LOYALTIES",
                subtitle: "Partners separated across time streams",
                concept: "INDIVIDUAL PERFORMANCE & TRUST",
                icon: "split",
                description: "Team members are isolated and evaluated independently across analytical tasks, ethical judgments, and pressure scenarios. No communication allowed.",
                outcomes: [
                    { label: "Both below benchmark", value: "ELIMINATION", color: "text-red-500" },
                    { label: "Split performance", value: "Solo OR Revival", color: "text-yellow-500" },
                    { label: "Both strong", value: "Partnership continues", color: "text-green-500" }
                ],
                special: "The Revival Gamble: Eliminated partners may be reinstated at a point cost.",
                quote: "\"Save your ally and handicap yourself, or proceed alone.\""
            },
            {
                id: 3,
                title: "THE BARTER TRADE",
                subtitle: "Value is fluid. Liquidity is illusion.",
                concept: "RESOURCE ARBITRAGE",
                icon: "refresh-cw",
                description: "Teams receive unique resource portfolios with differing utilities and liquidity. Must negotiate with competitors to construct optimal portfolio.",
                twist: "Mid-round shift: High-demand resources devalued. Obscure assets become critical.",
                criteria: ["Portfolio value vs. benchmark", "Strategic coherence", "Risk exposure"]
            },
            {
                id: 4,
                title: "THE INSIDER'S DILEMMA",
                subtitle: "Knowledge is power. Power is dangerous.",
                concept: "INFORMATION ASYMMETRY & RISK",
                icon: "eye-off",
                description: "Teams receive classified information: legitimate intel, misleading rumors, and illegal non-public data. Must invest without knowing source reliability.",
                enforcement: "Post-decision probabilistic audit system. Illegal usage may yield returns or trigger penalties.",
                defense: ["Financial rationale", "Risk assessment", "Ethical navigation"]
            }
        ];

        function render(){
            // Check if admin mode - don't render team view
            if(_get(_K4) === "true"){
                window.location.replace("admin.html");
                return;
            }

            const team = _get(_K1);

            if(!team){
                // Show login screen
                document.getElementById("team-login-screen").style.display = "flex";
                // Hide main content
                document.getElementById("main-content").style.display = "none";
                document.getElementById("rounds-section").style.display = "none";
                return;
            }

            // Hide login screen
            document.getElementById("team-login-screen").style.display = "none";
            // Show main content
            document.getElementById("main-content").style.display = "block";
            document.getElementById("rounds-section").style.display = "block";
            
            document.getElementById("welcome").innerText = `WELCOME, TEAM ${team}`;

            const state = getState();
            const decrypted = getDecrypted();
            const container = document.getElementById("rounds-container");
            container.innerHTML = "";

            roundsData.forEach(round => {
                const status = state[round.id][team] || "revoked";
                const canDecrypt = (status === "access" || status === "passed");
                const hasDecrypted = decrypted[`${team}_${round.id}`] === true;

                if(status === "revoked" && hasDecrypted){
                    delete decrypted[`${team}_${round.id}`];
                    _set(_K3, decrypted);
                }

                const locked = !canDecrypt || !hasDecrypted;
                const roundNum = String(round.id).padStart(2, '0');

                const html = `
                    <div id="round${round.id}" class="relative scroll-mt-24" data-round-id="${round.id}">
                        <div class="absolute -left-2 md:-left-12 top-0 font-mono text-[6rem] md:text-[12rem] font-bold ${locked ? 'text-gray-800' : 'text-capital-red/5'} select-none -z-10">
                            ${roundNum}
                        </div>

                        <div class="relative z-10 border-l-2 ${locked ? 'border-gray-800' : 'border-capital-red'} pl-6 md:pl-12 py-8 min-h-[400px]">

                            ${locked ? `
                                <div class="locked-overlay absolute inset-0 z-30 flex flex-col items-center justify-center -m-4 md:-m-8 p-4 md:p-8 rounded-lg">
                                    <div class="classified-stamp px-4 py-2 text-2xl md:text-4xl mb-4 glitch-text text-center">
                                        CLASSIFIED
                                    </div>

                                    <div class="w-full max-w-md space-y-4">
                                        <div class="text-center mb-6">
                                            <p class="text-gray-400 font-mono text-xs md:text-sm mb-2">ROUND ${round.id} ENCRYPTION</p>
                                            <div class="flex items-center justify-center gap-2 text-capital-red">
                                                <i data-lucide="lock" class="w-4 h-4"></i>
                                                <span class="font-mono text-xs tracking-widest">TEAM CODE REQUIRED</span>
                                            </div>
                                        </div>

                                        <input type="text" id="code-${round.id}" class="code-input w-full p-4 font-mono text-lg uppercase tracking-widest rounded" placeholder="ENTER TEAM CODE" autocomplete="off">

                                        <button onclick="attempt(${round.id})" class="unlock-btn w-full py-3 font-display text-lg tracking-wider rounded flex items-center justify-center gap-2 mt-4">
                                            <span>DECRYPT</span>
                                            <i data-lucide="unlock" class="w-5 h-5"></i>
                                        </button>

                                        <div id="msg-${round.id}" class="text-center mt-4"></div>
                                    </div>

                                    <p class="text-gray-600 font-mono text-xs mt-8 text-center max-w-xs">
                                        Use your assigned team name (uppercase).
                                    </p>
                                </div>
                            ` : ''}

                            <!-- Unlocked content -->
                            <div class="${locked ? 'blur-content opacity-30' : ''}">
                                <div class="flex flex-wrap items-center gap-3 mb-4">
                                    <i data-lucide="${round.icon}" class="w-5 h-5 md:w-6 md:h-6 text-capital-red"></i>
                                    <span class="font-mono text-xs text-capital-red tracking-widest uppercase">${round.concept}</span>
                                    ${!locked ? `<span class="ml-auto font-mono text-xs text-capital-red flex items-center gap-1"><i data-lucide="unlock" class="w-3 h-3"></i> DECRYPTED</span>` : ''}
                                </div>

                                <h2 class="font-display text-3xl md:text-7xl text-white mb-2 md:mb-4 leading-tight">${round.title}</h2>
                                <p class="font-script text-xl md:text-2xl text-gray-500 mb-6 md:mb-8">${round.subtitle}</p>

                                <div class="grid md:grid-cols-2 gap-6 md:gap-8">
                                    <div class="space-y-4 text-gray-300 font-mono text-sm leading-relaxed">
                                        <p>${round.description}</p>

                                        ${round.mechanism ? `
                                            <div class="bg-gray-900/50 p-3 md:p-4 border-l-2 border-capital-red">
                                                <p class="text-xs uppercase text-gray-500 mb-2">THE MECHANISM</p>
                                                <ul class="space-y-2 text-gray-400 text-xs md:text-sm">
                                                    ${round.mechanism.map(m => `<li class="flex gap-2"><span class="text-capital-red">›</span> ${m}</li>`).join('')}
                                                </ul>
                                            </div>
                                        ` : ''}

                                        ${round.outcomes ? `
                                            <div class="bg-gray-900/50 p-3 md:p-4 border-l-2 border-capital-red">
                                                <p class="text-xs uppercase text-gray-500 mb-2">OUTCOME MATRIX</p>
                                                <div class="space-y-1 text-xs md:text-sm">
                                                    ${round.outcomes.map(o => `
                                                        <div class="flex justify-between border-b border-gray-800 pb-1 last:border-0">
                                                            <span class="text-gray-400 text-xs">${o.label}</span>
                                                            <span class="${o.color} font-bold text-xs">${o.value}</span>
                                                        </div>
                                                    `).join('')}
                                                </div>
                                            </div>
                                        ` : ''}

                                        ${round.twist ? `
                                            <div class="bg-gray-900/50 p-3 md:p-4 border-l-2 border-capital-red">
                                                <p class="text-xs uppercase text-gray-500 mb-1">THE TWIST</p>
                                                <p class="text-gray-300 text-xs md:text-sm">${round.twist}</p>
                                            </div>
                                        ` : ''}

                                        ${round.enforcement ? `
                                            <div class="bg-gray-900/50 p-3 md:p-4 border-l-2 border-capital-red">
                                                <p class="text-xs uppercase text-gray-500 mb-1">ENFORCEMENT</p>
                                                <p class="text-gray-300 text-xs md:text-sm">${round.enforcement}</p>
                                            </div>
                                        ` : ''}
                                    </div>

                                    <div class="space-y-3 md:space-y-4">
                                        ${round.elimination ? `
                                            <div class="bg-capital-red/5 border border-capital-red/20 p-4 md:p-6">
                                                <h4 class="font-display text-lg md:text-xl text-white mb-2">ELIMINATION TRIGGERS</h4>
                                                <ul class="font-mono text-xs md:text-sm text-gray-400 space-y-1">
                                                    ${round.elimination.map(e => `<li class="flex gap-2"><span class="text-capital-red">›</span> ${e}</li>`).join('')}
                                                </ul>
                                            </div>
                                        ` : ''}

                                        ${round.criteria ? `
                                            <div class="bg-gray-900 p-4 md:p-6 border border-gray-800">
                                                <h4 class="font-display text-lg md:text-xl text-capital-red mb-2">EVALUATION CRITERIA</h4>
                                                <ul class="font-mono text-xs md:text-sm text-gray-400 space-y-1">
                                                    ${round.criteria.map(c => `<li class="flex gap-2"><span class="text-capital-red">›</span> ${c}</li>`).join('')}
                                                </ul>
                                            </div>
                                        ` : ''}

                                        ${round.defense ? `
                                            <div class="bg-capital-red/10 border border-capital-red p-4 md:p-6">
                                                <h4 class="font-display text-lg md:text-xl text-white mb-2">DEFENSE REQUIRED</h4>
                                                <ul class="font-mono text-xs md:text-sm text-gray-400 space-y-1">
                                                    ${round.defense.map(d => `<li class="flex gap-2"><span class="text-capital-red">›</span> ${d}</li>`).join('')}
                                                </ul>
                                            </div>
                                        ` : ''}

                                        ${round.special ? `
                                            <div class="bg-capital-red/5 border border-capital-red/20 p-4 md:p-6">
                                                <h4 class="font-display text-lg md:text-xl text-white mb-1">${round.special.split(':')[0]}</h4>
                                                <p class="font-mono text-xs text-gray-400 mb-2">${round.special.split(':').slice(1).join(':')}</p>
                                                ${round.quote ? `<p class="text-xs text-capital-red italic font-mono border-t border-capital-red/20 pt-2">${round.quote}</p>` : ''}
                                            </div>
                                        ` : ''}

                                        ${round.skills ? `
                                            <div class="bg-gray-900 p-4 md:p-6 border border-gray-800">
                                                <h4 class="font-display text-lg md:text-xl text-capital-red mb-2">SKILLS TESTED</h4>
                                                <p class="font-mono text-xs md:text-sm text-gray-400">${round.skills}</p>
                                            </div>
                                        ` : ''}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;

                container.innerHTML += html;
            });

            lucide.createIcons();
        }

        function attempt(id){
            const team = _get(_K1);
            if(!team) return;

            const state = getState();
            const decrypted = getDecrypted();
            const msg = document.getElementById("msg-"+id);
            const entered = document.getElementById("code-"+id).value.trim().toUpperCase();

            msg.innerHTML = '';

            if(entered !== team){
                msg.innerHTML = `<p class="text-red-500 font-mono text-xs mt-2 shake"><i data-lucide="alert-triangle" class="w-3 h-3 inline mr-1"></i>WRONG TEAM CODE</p>`;
                lucide.createIcons();
                return;
            }

            const s = state[id][team] || "revoked";

            if(s === "revoked"){
                msg.innerHTML = `<p class="text-red-500 font-mono text-xs mt-2 shake"><i data-lucide="alert-triangle" class="w-3 h-3 inline mr-1"></i>ACCESS NOT GRANTED BY ADMIN</p>`;
                lucide.createIcons();
                return;
            }

            if(s === "eliminated"){
                // Show full elimination screen
                showEliminationScreen(id);
                return;
            }

            decrypted[`${team}_${id}`] = true;
            _set(_K3, decrypted);

            msg.innerHTML = `<p class="text-green-500 font-mono text-xs mt-2"><i data-lucide="check-circle" class="w-3 h-3 inline mr-1"></i>DECRYPTION SUCCESSFUL</p>`;
            lucide.createIcons();

            setTimeout(() => render(), 1500);
        }

        function showEliminationScreen(roundId){
            const roundNames = {
                1: "Round 1 — THE AUCTION OF CONSEQUENCES",
                2: "Round 2 — DIVIDED LOYALTIES",
                3: "Round 3 — THE BARTER TRADE",
                4: "Round 4 — THE INSIDER'S DILEMMA"
            };

            document.getElementById("elim-round-name").innerText = roundNames[roundId] || `Round ${roundId}`;
            document.getElementById("elimination-screen").style.display = "flex";
            lucide.createIcons();
        }

        function closeEliminationScreen(){
            document.getElementById("elimination-screen").style.display = "none";
        }

        window.addEventListener("load", () => {
            const nav = performance.getEntriesByType("navigation")[0];
            if(nav && nav.type === "reload"){
                localStorage.removeItem(_K1);
            }
            render();
        });
    </script>
</body>
</html>